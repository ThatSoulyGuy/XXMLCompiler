# Testing the XXML Compiler

This guide explains how to test the XXML compiler with the provided test files.

## Test Files

### 1. Test.XXML (Basic Test)
**Purpose**: Original test file demonstrating core features
**Lines**: ~40
**Features**: Basic namespace, class, method, for loop

### 2. ComprehensiveTest.XXML (Full Test Suite)
**Purpose**: Comprehensive test of ALL language features
**Lines**: 600+
**Features**: All 58 language features

## Quick Test (5 minutes)

### Step 1: Build the Compiler
```bash
# Windows
build.bat

# Linux/macOS
chmod +x build.sh
./build.sh
```

### Step 2: Test with Basic File
```bash
# Compile Test.XXML
./build/bin/xxml Test.XXML test_output.cpp

# On Windows:
# build\bin\Release\xxml.exe Test.XXML test_output.cpp
```

### Step 3: Verify Output
Check that `test_output.cpp` was created:
```bash
# Linux/macOS
ls -lh test_output.cpp

# Windows
dir test_output.cpp
```

### Step 4: Inspect Generated C++
```bash
# View the generated code
cat test_output.cpp

# Or open in your editor
code test_output.cpp
```

Expected output should include:
- C++ headers (`#include <iostream>`, etc.)
- Namespace declarations
- Class definitions
- main() function

## Comprehensive Test (10 minutes)

### Step 1: Compile Comprehensive Test
```bash
./build/bin/xxml ComprehensiveTest.XXML comprehensive_output.cpp

# Expected output:
# XXML Compiler v1.0
# ==================
# Reading source file: ComprehensiveTest.XXML
# Running lexical analysis...
#   Tokens generated: 2000+
# Running syntax analysis...
#   AST constructed successfully
# Running semantic analysis...
#   Semantic analysis passed
# Generating C++ code...
# Writing output to: comprehensive_output.cpp
# âœ“ Compilation successful!
```

### Step 2: Check Generated File Size
```bash
ls -lh comprehensive_output.cpp

# Should be several KB (the comprehensive test generates a lot of C++)
```

### Step 3: Examine Generated Code
```bash
head -50 comprehensive_output.cpp
```

Should see:
```cpp
// Generated by XXML Compiler
// Do not edit this file manually

#include <iostream>
#include <string>
#include <memory>
#include <cstdint>

namespace TestSuite::Core {
    class Animal {
    private:
        std::unique_ptr<std::string> name;
        std::unique_ptr<int64_t> age;
    public:
        Animal() = default;
        // ... more code
    };
}
```

## Feature-by-Feature Testing

### Test Lexer (Tokenization)
```bash
# The lexer will process all tokens and report count
./build/bin/xxml Test.XXML output.cpp

# Look for: "Tokens generated: XXX"
```

### Test Parser (Syntax)
```bash
# The parser will build the AST
./build/bin/xxml Test.XXML output.cpp

# Look for: "AST constructed successfully"
```

### Test Semantic Analyzer (Type Checking)
```bash
# Semantic analysis will check types and ownership
./build/bin/xxml Test.XXML output.cpp

# Look for: "Semantic analysis passed"
```

### Test Code Generator
```bash
# Code generator will create C++
./build/bin/xxml Test.XXML output.cpp

# Look for: "âœ“ Compilation successful!"
```

## Error Testing

### Test Lexical Errors
Create `error_test_lex.xxml`:
```xxml
[ Namespace <Test>
    Property "unterminated string
]
```

Compile:
```bash
./build/bin/xxml error_test_lex.xxml output.cpp

# Expected: Error message with location
```

### Test Syntax Errors
Create `error_test_syntax.xxml`:
```xxml
[ Namespace <Test>
    [ Class Missing closing bracket
]
```

Compile:
```bash
./build/bin/xxml error_test_syntax.xxml output.cpp

# Expected: Syntax error with line number
```

### Test Semantic Errors
Create `error_test_semantic.xxml`:
```xxml
[ Namespace <Test>
    [ Class <MyClass> Final Extends None
        [ Public <>
            Property <x> Types UndefinedType^;
        ]
    ]
]
```

Compile:
```bash
./build/bin/xxml error_test_semantic.xxml output.cpp

# Expected: "Type 'UndefinedType' not found"
```

## Performance Testing

### Measure Compilation Time
```bash
# Linux/macOS
time ./build/bin/xxml ComprehensiveTest.XXML output.cpp

# Windows (PowerShell)
Measure-Command { .\build\bin\Release\xxml.exe ComprehensiveTest.XXML output.cpp }
```

### Check Memory Usage
```bash
# Linux
/usr/bin/time -v ./build/bin/xxml ComprehensiveTest.XXML output.cpp

# Look for "Maximum resident set size"
```

## Regression Testing

### Create a Test Script

**test_all.sh** (Linux/macOS):
```bash
#!/bin/bash
echo "Running XXML Compiler Tests"
echo "==========================="

# Test 1: Basic
echo "Test 1: Basic Test.XXML"
./build/bin/xxml Test.XXML test1_output.cpp
if [ $? -eq 0 ]; then
    echo "âœ“ Test 1 passed"
else
    echo "âœ— Test 1 failed"
    exit 1
fi

# Test 2: Comprehensive
echo "Test 2: Comprehensive Test"
./build/bin/xxml ComprehensiveTest.XXML test2_output.cpp
if [ $? -eq 0 ]; then
    echo "âœ“ Test 2 passed"
else
    echo "âœ— Test 2 failed"
    exit 1
fi

echo "==========================="
echo "All tests passed!"
```

**test_all.bat** (Windows):
```batch
@echo off
echo Running XXML Compiler Tests
echo ===========================

echo Test 1: Basic Test.XXML
build\bin\Release\xxml.exe Test.XXML test1_output.cpp
if %ERRORLEVEL% neq 0 (
    echo X Test 1 failed
    exit /b 1
)
echo âˆš Test 1 passed

echo Test 2: Comprehensive Test
build\bin\Release\xxml.exe ComprehensiveTest.XXML test2_output.cpp
if %ERRORLEVEL% neq 0 (
    echo X Test 2 failed
    exit /b 1
)
echo âˆš Test 2 passed

echo ===========================
echo All tests passed!
```

Run:
```bash
# Linux/macOS
chmod +x test_all.sh
./test_all.sh

# Windows
test_all.bat
```

## CMake Testing

The project includes CMake tests:

```bash
cd build
ctest

# Verbose output
ctest -V

# Run specific test
ctest -R TestXXMLCompilation
```

## Test Coverage Checklist

Use this checklist to verify all features work:

- [ ] Imports are recognized
- [ ] Namespaces are created
- [ ] Classes are declared
- [ ] Inheritance works
- [ ] Access modifiers (Public/Private/Protected)
- [ ] Properties with ownership (^, &, %)
- [ ] Constructors (default)
- [ ] Methods with parameters
- [ ] Return statements
- [ ] For loops
- [ ] Instantiate statements
- [ ] Run statements
- [ ] Method calls
- [ ] Method chaining
- [ ] Reference passing (&var)
- [ ] Arithmetic operators (+, -, *, /, %)
- [ ] String literals
- [ ] Integer literals (42i)
- [ ] Qualified names (Namespace::Class)
- [ ] Comments (//)
- [ ] Exit statement
- [ ] Entrypoint block

## Troubleshooting

### Issue: "File not found"
**Solution**: Check file path is correct
```bash
ls -l Test.XXML
# Make sure file exists
```

### Issue: "Permission denied"
**Solution**: Make binary executable
```bash
chmod +x build/bin/xxml
```

### Issue: "Compilation errors"
**Solution**: Check error messages carefully
- Look at file:line:column
- Read the error message
- Check syntax in LANGUAGE_SPEC.md

### Issue: "No output file created"
**Solution**: Check compiler return code
```bash
./build/bin/xxml Test.XXML output.cpp
echo $?  # Should be 0 for success
```

## Success Criteria

A successful test should:
1. âœ… Exit with code 0
2. âœ… Create output.cpp file
3. âœ… Show "âœ“ Compilation successful!"
4. âœ… Generate valid C++ code
5. âœ… Have no error messages

## Next Steps

After testing:
1. Review generated C++ code quality
2. Try compiling generated C++ (see QUICKSTART.md)
3. Create your own XXML programs
4. Report any issues found

## Test Results Log

Keep a log of your test results:

```
Date: 2025-XX-XX
Compiler Version: 1.0
Test: ComprehensiveTest.XXML
Result: PASS
Tokens: 2847
Compilation Time: 0.5s
Output Size: 15KB
Notes: All features working correctly
```

---

**Happy Testing!** ðŸ§ª

For more information, see:
- [QUICKSTART.md](QUICKSTART.md) - Getting started
- [FEATURES_TESTED.md](FEATURES_TESTED.md) - What each test covers
- [README.md](README.md) - Full documentation
